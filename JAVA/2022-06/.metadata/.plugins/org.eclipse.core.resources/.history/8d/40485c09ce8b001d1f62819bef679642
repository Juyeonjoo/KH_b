package org.zerock.jdbcexamples;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.Timestamp;
import java.util.Objects;

import lombok.extern.log4j.Log4j2;

@Log4j2
public class Example4 {


	public static void main(String[] args){
		ResultSet rs =null;
		
		String sql = """
				SELECT *
				FROM employees
				-- ? = Bind Variable 
				WHERE salary > ? 
				""";
		
		try(
				static final String jdbcDriver ="oracle.jdbc.OracleDriver";
				static final String jdbcTNSNamesUrl = "jdbc:oracle:thin:@xepdb1";
				static final String jdbcOracleCloudUrl = "jdbc:oracle:thin:@iabobij3bs5jnh34_high?TNS_ADMIN=C:/opt/OracleCloudWallet/VFX";
				
				static final String user = "HR";
				static final String passForCloud = "Oracle123456789";
				static final String passForLocal = "oracle";
				
			Connection conn = DriverManager.getConnection(jdbcTNSNamesUrl,user,passForLocal); 
			PreparedStatement pstmt = conn.prepareStatement(sql);	
		) {
			log.info("1. conn: {}", conn);
			log.info("2. pstmt: {}", pstmt);
	
			pstmt.setDouble(1, 1000);
			
			rs = pstmt.executeQuery(); 
			log.info("3. rs: {}", rs);
			
			while(rs.next()) {  
				int employeeId = rs.getInt("employee_id"); 
				String firstName = rs.getString("FIRST_NAME");
				String lastName = rs.getString("LAST_NAME");
				Timestamp hireDate = rs.getTimestamp("HIRE_DATE");
				double salary = rs.getDouble("SALARY");
				
				log.info("employeeId: {}, firstName: {}, lastName: {}, hireDate: {}, salary: {}",
						employeeId, firstName, lastName, hireDate, salary);
			}//while	
		} catch(SQLException e) {
			e.printStackTrace();
		} //try-catch
	}//main
}//end class
