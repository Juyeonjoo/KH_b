package org.zerock.myapp;

import java.io.IOException;
import java.net.ServerSocket;

import lombok.Cleanup;
import lombok.extern.log4j.Log4j2;

@Log4j2
public class SingleThreadSocketServer {

	//FOCUS: TCP Networking 기반의 서버 프로그램 제작
	//		개발시 핵심은, 현재 단계에서는 지정된 Listen Port로 연결요청을 기다리다가(Listening)
	//		(1) 클라이언트의 연결요청이 들어오면 => 수락 => 연결생성(Connection) 하고, 
	// 		(2) 통신을 위한 Socket 객체 생성 까지가 이번 예제의 목표
	public static void main(String[] args) throws IOException {
		
		//Step.1 ServerSocket 객체 생성은, Listen Port를 인자값으로 줘서 생성
		
		int listenPort = 7777;
		
		@Cleanup
		ServerSocket serverSocket = new ServerSocket(listenPort);
		log.info("1. serverSocket: {}", serverSocket);
		//Step.2 연결요청기다리는 것=>무한루프
		//무한루프를 이용해서 언제 들어올지 모르는 클라이언트로부터의 연결요청을
		//Listening(대기)하게 함 
		
		while(true) { //무한루프
			log.info("2. Start Listening ...");
			serverSocket.accept();//지정된 Listen Port로 Listening 수행, 연결수락
		}//while
		
		
		
		
		
		
	}//main
}//end class
